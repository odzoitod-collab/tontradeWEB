-- ==========================================
-- üåç 3. COUNTRIES (–†–ï–ö–í–ò–ó–ò–¢–´)
-- ==========================================

DROP TABLE IF EXISTS public.country_bank_details CASCADE;

CREATE TABLE public.country_bank_details (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    country_name TEXT NOT NULL UNIQUE,       -- –ù–∞–∑–≤–∞–Ω–∏–µ
    country_code TEXT NOT NULL,              -- –ö–æ–¥ (RU, KZ...)
    currency TEXT NOT NULL,                  -- –í–∞–ª—é—Ç–∞ (RUB...)
    bank_details TEXT NOT NULL,              -- –†–µ–∫–≤–∏–∑–∏—Ç—ã (—Ç–µ–∫—Å—Ç)
    exchange_rate FLOAT DEFAULT 1.0,         -- –ö—É—Ä—Å
    is_active BOOLEAN DEFAULT TRUE,          
    created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now())
);

-- –ü—Ä–µ—Å–µ—Ç—ã
INSERT INTO public.country_bank_details (country_name, country_code, currency, bank_details, exchange_rate) VALUES
('–†–æ—Å—Å–∏—è', 'RU', 'RUB', E'–°–±–µ—Ä–±–∞–Ω–∫: 2202 2002 0000 0000\n–°–ë–ü: +7 900 000-00-00\n–ü–æ–ª—É—á–∞—Ç–µ–ª—å: –î—Ä–æ–ø –ò.', 0.0105),
('–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω', 'KZ', 'KZT', E'Kaspi Gold: 4400 4301 0000 0000\n–ü–æ–ª—É—á–∞—Ç–µ–ª—å: –î—Ä–æ–ø –ö.', 0.0022),
('–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω', 'UZ', 'UZS', E'Uzcard: 8600 0000 0000 0000\n–ü–æ–ª—É—á–∞—Ç–µ–ª—å: –î—Ä–æ–ø –£.', 0.000081),
('Crypto (USDT)', 'US', 'USDT', E'TRC20: TJsSd....(–∫–æ—à–µ–ª–µ–∫)...\nNetwork: TRON', 1.0);

-- RLS
ALTER TABLE public.country_bank_details ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Enable all for countries" ON public.country_bank_details FOR ALL USING (true) WITH CHECK (true);